<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hamster Tamagotchi Final Fix</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      /* === í”„ë ˆì„ ì„¤ì • === */
      --frame-w: 673px;
      --frame-h: 673px;

      /* === ìƒë‹¨ í™”ë©´ ìœ„ì¹˜ ì•ˆì •í™” === */
      --screen-top-x: 138px;
      --screen-top-y: 112px;  /* 112pxë¡œ ìˆ˜ì •ë˜ì–´ ê²€ì€ ì—¬ë°± ì œê±°ë¨ */
      --screen-top-w: 396px;
      --screen-top-h: 290px; 

      /* === í•˜ë‹¨ íŒ¨ë„ ìœ„ì¹˜ === */
      --panel-x: 142px;
      --panel-y: 408px;
      --panel-w: 390px;
      --panel-h: 135px;

      /* [í…Œë§ˆ] ê²Œì„ë³´ì´ ê·¸ë¦° */
      --color-bg: #9bbc0f;      
      --color-ui-bg: #8bac0f;   
      --color-text: #0f380f;    
      --exp-bar-bg: #306230;    
      --exp-bar-fill: #0f380f;  

      /* === A, B, C ë²„íŠ¼ ìœ„ì¹˜ === */
      --btn-size: 56px;
      --btn-bottom: 68px;
      --btn-b-bottom: 50px;
      --btn-a-left: 178px;
      --btn-b-left: 308px;
      --btn-c-left: 438px;
    }

    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      min-height: 100vh;
      overflow: hidden;
      background-color: #222;
      font-family: 'Press Start 2P', 'Noto Sans KR', sans-serif;
    }

    /* ë°˜ì‘í˜• ë˜í¼ (Notion ì„ë² ë“œìš©) */
    .device-wrapper {
      position: fixed;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 10px;
      overflow: hidden;
    }

    .scale-wrapper {
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
    }

    .device-container {
      position: relative;
      width: var(--frame-w);
      height: var(--frame-h);
      transform-origin: top left;
      flex-shrink: 0;
    }

    /* === ë ˆì´ì–´ 1: ìƒë‹¨ í™”ë©´ === */
    .screen-top {
      position: absolute;
      left: var(--screen-top-x);
      top: var(--screen-top-y);
      width: var(--screen-top-w);
      height: var(--screen-top-h);
      background-color: var(--color-bg);
      z-index: 10;
      overflow: hidden; 
      border-radius: 25px 25px 10px 10px; 
    }

    .bg-image {
      width: 100%;
      height: 100%; 
      object-fit: cover;
      object-position: center bottom; 
      image-rendering: pixelated;
      display: block;
    }

    /* í–„ìŠ¤í„° ìœ„ì¹˜ ì¡°ì • */
    .hamster {
      position: absolute;
      width: 280px; 
      height: 280px;
      left: 50%; 
      top: 65%; 
      transform: translate(-50%, -50%);
      image-rendering: pixelated;
      z-index: 20;
    }

    /* === ë ˆì´ì–´ 2: í•˜ë‹¨ íŒ¨ë„ === */
    .screen-bottom {
      position: absolute;
      left: var(--panel-x);
      top: var(--panel-y);
      width: var(--panel-w);
      height: var(--panel-h);
      background-color: var(--color-ui-bg);
      z-index: 10;
      border-radius: 5px 5px 30px 30px; 
      padding: 0; 
      display: flex;
      gap: 0; 
      color: var(--color-text);
      align-items: stretch;
    }

    /* === ë ˆì´ì–´ 3: í”„ë ˆì„ === */
    .layer-frame {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 100; 
      pointer-events: none; 
    }
    .layer-frame img { width: 100%; display: block; }

    /* ì™¼ìª½ íŒ¨ë„ (LV/EXP) */
    .panel-left {
      flex: 1;
      width: 50%; 
      display: flex;
      flex-direction: column;
      justify-content: center; 
      align-items: center; 
      padding-top: 0;
      padding-bottom: 15px;
      border-right: 2px dashed rgba(15, 56, 15, 0.5); 
    }

    .stat-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      width: 100px; 
      margin-bottom: 2px;
    }

    .stat-row span:first-child {
      font-size: 14px;
      font-weight: bold;
      color: #0f380f; 
    }

    #expText {
      font-size: 10px; 
      color: #306230;
      font-weight: normal;
    } 

    .val-level { 
      font-size: 16px; 
      color: #d32f2f; 
      text-shadow: 1px 1px 0px rgba(0,0,0,0.1);
    }

    .exp-track {
      width: 120px;
      height: 14px;
      background: var(--exp-bar-bg);
      border: 2px solid var(--color-text);
      border-radius: 4px;
      position: relative;
      overflow: hidden;
    }
    .exp-fill {
      height: 100%;
      width: 0%;
      background-color: var(--exp-bar-fill);
      transition: width 0.3s;
    }

    /* ì˜¤ë¥¸ìª½ íŒ¨ë„ (ë¡œê·¸) */
    .panel-right {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: flex-start;
      padding-top: 10px; 
      padding-left: 20px; 
      overflow: hidden;
    }

    .log-title {
      font-size: 8px;
      margin-top: 5px;
      margin-bottom: 10px;
      opacity: 0.6;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .log-content {
      width: 100%;
      flex: 1;
      font-family: 'Noto Sans KR', sans-serif;
      overflow-y: auto;
      font-size: 11px;
      line-height: 1.5;
      padding-bottom: 5px; 
      scrollbar-width: none; 
      display: flex;
      flex-direction: column;
      justify-content: flex-start; 
      gap: 2px; 
      padding-top: 0; 
    }
    .log-content::-webkit-scrollbar { display: none; }
    
    .log-item { margin-bottom: 3px; }
    .log-item.new { color: #d32f2f; font-weight: bold; animation: flash 0.5s; }
    @keyframes flash { 0% { opacity: 0; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

    /* ë²„íŠ¼ ì˜ì—­ */
    .btn-area {
      position: absolute;
      bottom: var(--btn-bottom);
      width: var(--btn-size);
      height: var(--btn-size);
      z-index: 200;
      cursor: pointer;
      border-radius: 50%;
    }
    .btn-a { left: var(--btn-a-left); }
    .btn-b { left: var(--btn-b-left); bottom: var(--btn-b-bottom); }
    .btn-c { left: var(--btn-c-left); }

    .bounce { animation: bounce 2s infinite ease-in-out; }
    @keyframes bounce { 
      0%, 100% { transform: translate(-50%, -50%) translateY(0); } 
      50% { transform: translate(-50%, -50%) translateY(-6px); } 
    }
  </style>
</head>
<body>

  <div class="device-wrapper" id="deviceWrapper">
  <div class="scale-wrapper" id="scaleWrapper">
  <div class="device-container" id="device">
    
    <div class="screen-top">
      <img src="./assets/bg.png" class="bg-image" alt="ë°°ê²½">
      <img src="./assets/normal.png" class="hamster bounce" id="hamster" alt="í–„ìŠ¤í„°">
    </div>

    <div class="screen-bottom">
      <div class="panel-left">
        <div class="stat-row">
          <span>LV.</span>
          <span class="val-level" id="uiLevel">1</span>
        </div>

        <div class="stat-row">
          <span>EXP</span>
          <span id="expText">0%</span>
        </div>

        <div class="exp-track">
          <div class="exp-fill" id="uiExp"></div>
        </div>
      </div>
      <div class="panel-right">
        <div class="log-title">SYSTEM LOG</div>
        <div class="log-content" id="uiLog">
          <div>> ì‹œìŠ¤í…œ ê°€ë™..</div>
          <div>> í–„ìŠ¤í„°ê°€ ê¸°ë‹¤ë ¤ìš”!</div>
        </div>
      </div>
    </div>

    <div class="layer-frame">
      <img src="./assets/frame.png" alt="Frame">
    </div>

    <div class="btn-area btn-a" onclick="handleBtn('A')" title="ë°¥ì£¼ê¸°"></div>
    <div class="btn-area btn-b" onclick="handleBtn('B')" title="ì“°ë‹¤ë“¬ê¸°"></div>
    <div class="btn-area btn-c" onclick="handleBtn('C')" title="ë†€ì•„ì£¼ê¸°"></div>

  </div>
  </div>
  </div>

  <script>
    const hamster = document.getElementById('hamster');
    const uiLevel = document.getElementById('uiLevel');
    const uiExp = document.getElementById('uiExp');
    const expText = document.getElementById('expText');
    const uiLog = document.getElementById('uiLog');

    /* [ìˆ˜ì •] ì‹œì‘ ë ˆë²¨ 1, ê²½í—˜ì¹˜ 0ìœ¼ë¡œ ì´ˆê¸°í™” */
    let game = { level: 1, exp: 0, maxExp: 100, isBusy: false };

    function init() {
      updateUI();
      fitScale();
      window.addEventListener('resize', fitScale);
    }

    function fitScale() {
      const device = document.getElementById('device');
      const scaleWrapper = document.getElementById('scaleWrapper');
      const fw = 673, fh = 673;
      const pad = 20;
      const scale = Math.min(
        (window.innerWidth - pad) / fw,
        (window.innerHeight - pad) / fh,
        1
      );
      scaleWrapper.style.width = (fw * scale) + 'px';
      scaleWrapper.style.height = (fh * scale) + 'px';
      device.style.transform = `scale(${scale})`;
    }

    function handleBtn(btn) {
      if(game.isBusy) return;
      game.isBusy = true;

      // [ì£¼ì˜] í´ë”ì— eat.png, happy.png íŒŒì¼ì´ ê¼­ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
      if(btn === 'A') {
        log("ëƒ ëƒ ! í•´ë°”ë¼ê¸°ì”¨ ë§›ìˆë‹¤ +10");
        changeAction('./assets/eat.png', 2000);
        addExp(10);
      } else if(btn === 'B') {
        log("ì“°ë‹´ì“°ë‹´.. ê¸°ë¶„ ìµœê³ ! +5");
        changeAction('./assets/happy.png', 2000);
        addExp(5);
      } else if(btn === 'C') {
        log("ì³‡ë°”í€´ ëŒë¦¬ê¸°! ì˜ì°¨ì˜ì°¨ +15");
        changeAction('./assets/happy.png', 2000); 
        addExp(15);
      }
    }

    /* ì´ë¯¸ì§€ ì‚¬ë¼ì§ ë°©ì§€ */
    function changeAction(imgSrc, duration) {
      const originalSrc = './assets/normal.png';
      hamster.src = imgSrc;
      hamster.classList.remove('bounce');
      
      // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì›ìƒë³µêµ¬
      hamster.onerror = function() {
        console.warn("ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:", imgSrc);
        log("âš  ì˜¤ë¥˜: ì´ë¯¸ì§€ê°€ ì—†ì–´ìš”!");
        hamster.src = originalSrc;
        hamster.classList.add('bounce');
        game.isBusy = false;
      };

      setTimeout(() => {
        hamster.src = originalSrc;
        hamster.classList.add('bounce');
        game.isBusy = false;
        hamster.onerror = null; 
      }, duration);
    }

    function addExp(amount) {
      game.exp += amount;
      if(game.exp >= game.maxExp) {
        game.level++;
        game.exp -= game.maxExp;
        log(`ğŸ”¥ ë ˆë²¨ ì—…! LV.${game.level}ğŸ”¥`);
      }
      updateUI();
    }

    function updateUI() {
      uiLevel.innerText = game.level;
      const pct = Math.min(100, (game.exp / game.maxExp) * 100);
      uiExp.style.width = `${pct}%`;
      expText.innerText = `${Math.floor(pct)}%`;
    }

    function log(msg) {
      const item = document.createElement('div');
      item.className = 'log-item new';
      item.innerText = `> ${msg}`;
      uiLog.prepend(item);
      if(uiLog.children.length > 20) uiLog.removeChild(uiLog.lastChild);
    }

    init();
  </script>
</body>
</html>