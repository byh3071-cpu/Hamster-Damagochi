<<<<<<< HEAD
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hamster Tamagotchi Widget</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root {
      /* === í”„ë ˆì„ ì„¤ì • (frame.png ê¸°ì¤€) === */
      --frame-w: 673px;
      --frame-h: 673px; /* ì •ì‚¬ê°í˜•ì— ê°€ê¹Œìš´ ë¹„ìœ¨ë¡œ ì¶”ì •ë¨ */
      
      /* ìƒ‰ìƒ í…Œë§ˆ */
      --color-screen-bg: #fdf6e3; /* ë©”ì¸ í™”ë©´ ë°°ê²½ìƒ‰ (ì´ë¯¸ì§€ ë¡œë“œ ì „) */
      --color-ui-bg: #e8dcb9;     /* í•˜ë‹¨ ì •ë³´ì°½ ë°°ê²½ìƒ‰ (ë² ì´ì§€) */
      --color-text: #4a3b32;      /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ (ê°ˆìƒ‰) */
      --color-accent: #00ff00;    /* ê²½í—˜ì¹˜ ë°” (í˜•ê´‘ ì´ˆë¡) */
    }

    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      display: grid;
      place-items: center;
      background-color: #1a1a1a;
      font-family: 'Press Start 2P', cursive;
      overflow: hidden;
    }

    /* === ì „ì²´ ì»¨í…Œì´ë„ˆ === */
    .device-container {
      position: relative;
      width: var(--frame-w);
      height: var(--frame-h);
      /* í™”ë©´ í¬ê¸°ì— ë§ì¶° ìë™ ì¶•ì†Œ */
      transform-origin: center center;
      transform: scale(0.8); 
    }

    /* === ë ˆì´ì–´ 1: í”„ë ˆì„ (ë§¨ ìœ„) === */
    .layer-frame {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 100; /* ì œì¼ ìœ„ì— ë°°ì¹˜ */
      pointer-events: none; /* í´ë¦­ í†µê³¼ */
    }
    .layer-frame img {
      width: 100%;
      display: block;
    }

    /* === ë ˆì´ì–´ 2: ë©”ì¸ í™”ë©´ (ìœ„ìª½ êµ¬ë©) === */
    /* frame.pngì˜ ìœ„ìª½ íˆ¬ëª… ì˜ì—­ì— ë§ì¶˜ ì¢Œí‘œ */
    .screen-top {
      position: absolute;
      top: 130px;    /* ìœ„ì—ì„œë¶€í„°ì˜ ê±°ë¦¬ */
      left: 135px;   /* ì™¼ìª½ì—ì„œë¶€í„°ì˜ ê±°ë¦¬ */
      width: 400px;  /* í™”ë©´ ë„ˆë¹„ */
      height: 300px; /* í™”ë©´ ë†’ì´ */
      background-color: var(--color-screen-bg);
      z-index: 10;
      overflow: hidden;
      border-radius: 20px;
    }

    /* ë°°ê²½ ì´ë¯¸ì§€ */
    .bg-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      image-rendering: pixelated;
    }

    /* í–„ìŠ¤í„° ìºë¦­í„° ê³µí†µ */
    .character {
      position: absolute;
      width: 180px;  /* ìºë¦­í„° í¬ê¸° ì¡°ì • */
      height: 180px;
      left: 50%;
      top: 55%;      /* ë°”ë‹¥(í†±ë°¥) ìœ„ì— ì„œ ìˆëŠ” ìœ„ì¹˜ */
      transform: translate(-50%, -50%);
      image-rendering: pixelated;
      transition: opacity 0.2s;
    }

    /* IDLE ìƒíƒœ ì• ë‹ˆë©”ì´ì…˜ (ìˆ¨ì‰¬ê¸°) */
    .character.idle {
      animation: breathe 2s infinite ease-in-out;
    }
    @keyframes breathe {
      0%, 100% { transform: translate(-50%, -50%) scaleY(1); }
      50% { transform: translate(-50%, -50%) scaleY(1.05); }
    }

    /* Running ìƒíƒœ (ì³‡ë°”í€´ ìŠ¤í”„ë¼ì´íŠ¸) */
    /* ë°°ê²½ì˜ ì³‡ë°”í€´ ìœ„ì¹˜ì— ì •í™•íˆ ë®ì–´ì”Œì›Œì•¼ í•¨ */
    .character.running {
      opacity: 0; /* img íƒœê·¸ ìˆ¨ê¸°ê¸° */
    }
    
    /* Running ìƒíƒœë¥¼ ìœ„í•œ ìŠ¤í”„ë¼ì´íŠ¸ ì˜¤ë²„ë ˆì´ */
    .sprite-overlay {
      display: none;
      position: absolute;
      /* ë°°ê²½ ì´ë¯¸ì§€ì˜ ì³‡ë°”í€´ ìœ„ì¹˜ì— ë§ì¶° ì¡°ì • */
      left: 20px; 
      top: 40px;
      width: 280px;
      height: 280px;
      background-image: url('./assets/wheel.png');
      background-size: 400% 200%; /* 2í–‰ 4ì—´ (8í”„ë ˆì„) */
      background-repeat: no-repeat;
      background-position: 0% 0%;
      image-rendering: pixelated;
      z-index: 20;
    }
    .sprite-overlay.active {
      display: block;
      animation: runSprite 0.8s steps(8) infinite;
    }

    @keyframes runSprite {
      0%{   background-position: 0%    0%; }    /* í”„ë ˆì„ 1 */
      12.5%{ background-position: 33.33% 0%; }  /* í”„ë ˆì„ 2 */
      25%{  background-position: 66.66% 0%; }  /* í”„ë ˆì„ 3 */
      37.5%{ background-position: 100%   0%; }  /* í”„ë ˆì„ 4 */
      50%{  background-position: 0%    100%; }  /* í”„ë ˆì„ 5 */
      62.5%{ background-position: 33.33% 100%; } /* í”„ë ˆì„ 6 */
      75%{  background-position: 66.66% 100%; } /* í”„ë ˆì„ 7 */
      87.5%{ background-position: 100%   100%; } /* í”„ë ˆì„ 8 */
      100%{ background-position: 0%    0%; }    /* ì²˜ìŒìœ¼ë¡œ */
    }

    /* === ë ˆì´ì–´ 3: ì •ë³´ í™”ë©´ (ì•„ë˜ìª½ êµ¬ë©) === */
    /* frame.pngì˜ ì•„ë˜ìª½ íˆ¬ëª… ì˜ì—­ì— ë§ì¶˜ ì¢Œí‘œ */
    .screen-bottom {
      position: absolute;
      top: 460px;
      left: 135px;
      width: 400px;
      height: 120px;
      background-color: var(--color-ui-bg); /* ë² ì´ì§€ìƒ‰ ë°°ê²½ */
      z-index: 10;
      padding: 15px;
      box-sizing: border-box;
      display: flex;
      flex-direction: row; /* ì¢Œìš° ë°°ì¹˜ */
      gap: 15px;
      border-radius: 10px;
    }

    /* ì™¼ìª½ íŒ¨ë„: ë ˆë²¨/ê²½í—˜ì¹˜ */
    .stat-panel {
      flex: 0 0 180px; /* ê³ ì • ë„ˆë¹„ */
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .stat-row {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      color: var(--color-text);
    }

    /* ê²½í—˜ì¹˜ ë°” ë””ìì¸ */
    .exp-container {
      flex-grow: 1;
      height: 14px;
      background: #555;
      border: 2px solid #000;
      position: relative;
      min-width: 120px;
    }
    .exp-fill {
      width: 0%;
      height: 100%;
      background-color: var(--color-accent);
      transition: width 0.3s ease-out;
      box-shadow: 0 0 5px var(--color-accent);
    }

    /* ì˜¤ë¥¸ìª½ íŒ¨ë„: ë¡œê·¸ ì˜ì—­ */
    .log-panel {
      flex: 1; /* ë‚¨ì€ ê³µê°„ ì°¨ì§€ */
      display: flex;
      flex-direction: column;
    }

    .log-title {
      font-size: 10px;
      color: var(--color-text);
      margin-bottom: 4px;
    }

    .log-area {
      flex: 1;
      background: rgba(255, 255, 255, 0.5);
      border: 2px solid #bba;
      font-size: 9px;
      padding: 6px;
      overflow-y: auto;
      color: #333;
      line-height: 1.4;
      min-height: 0; /* flexì—ì„œ ìŠ¤í¬ë¡¤ ì‘ë™í•˜ê²Œ */
    }

    /* === ê°œë°œìš© ë²„íŠ¼ (í™”ë©´ ë°–) === */
    .controls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 200;
    }
    .btn {
      background: #fff;
      border: 4px solid #000;
      padding: 10px;
      font-family: inherit;
      cursor: pointer;
      font-size: 10px;
    }
    .btn:active { transform: scale(0.95); }

  </style>
</head>
<body>

  <div class="device-container" id="device">
    
    <div class="layer-frame">
      <img src="./assets/frame.png" alt="Frame">
    </div>

    <div class="screen-top">
      <img src="./assets/bg.png" class="bg-image" alt="Background">
      
      <img src="./assets/normal.png" class="character idle" id="charImg" alt="Character">
      
      <div class="sprite-overlay" id="wheelSprite"></div>
    </div>

    <div class="screen-bottom">
      <!-- ì™¼ìª½: ë ˆë²¨/ê²½í—˜ì¹˜ -->
      <div class="stat-panel">
        <div class="stat-row">
          <span>LV.<span id="levelVal">1</span></span>
        </div>
        <div class="stat-row">
          <span>EXP</span>
          <div class="exp-container">
            <div class="exp-fill" id="expFill"></div>
          </div>
        </div>
      </div>
      
      <!-- ì˜¤ë¥¸ìª½: ë¡œê·¸ -->
      <div class="log-panel">
        <div class="log-title">LOG</div>
        <div class="log-area" id="logText">
          <div>> Welcome to Hamster World!</div>
        </div>
      </div>
    </div>

  </div>

  <div class="controls">
    <button class="btn" onclick="triggerAction('routine')">ğŸ‹ï¸ Routine (+20 EXP)</button>
    <button class="btn" onclick="triggerAction('task')">ğŸ“ Task (+10 EXP)</button>
    <button class="btn" onclick="resetGame()">ğŸ”„ Reset</button>
  </div>

  <script>
    /* === ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ === */
    const charImg = document.getElementById('charImg');
    const wheelSprite = document.getElementById('wheelSprite');
    const expFill = document.getElementById('expFill');
    const levelVal = document.getElementById('levelVal');
    const logText = document.getElementById('logText');

    let state = {
      level: 1,
      exp: 0,
      status: 'IDLE', // IDLE, RUNNING, EATING, SAD
      isBusy: false
    };

    // ì´ˆê¸°í™”
    function init() {
      renderUI();
      // ë°˜ì‘í˜• ìŠ¤ì¼€ì¼ë§
      window.addEventListener('resize', fitToScreen);
      fitToScreen();
    }

    // í™”ë©´ í¬ê¸°ì— ë§ì¶° ê¸°ê¸° í¬ê¸° ì¡°ì ˆ
    function fitToScreen() {
      const container = document.getElementById('device');
      const scale = Math.min(window.innerWidth / 700, window.innerHeight / 750);
      container.style.transform = `scale(${scale})`;
    }

    function triggerAction(type) {
      if (state.isBusy) return;
      state.isBusy = true;

      if (type === 'routine') {
        // ë£¨í‹´ ì™„ë£Œ -> ì³‡ë°”í€´ ë‹¬ë¦¬ê¸°
        log("> Routine Complete! Running...");
        setExp(20);
        
        // 1. ìºë¦­í„° ìˆ¨ê¸°ê³  ìŠ¤í”„ë¼ì´íŠ¸ ì¼œê¸°
        charImg.style.display = 'none';
        wheelSprite.classList.add('active');
        
        // 4ì´ˆ ë’¤ ë³µê·€
        setTimeout(() => {
          wheelSprite.classList.remove('active');
          charImg.style.display = 'block';
          state.isBusy = false;
        }, 4000);

      } else if (type === 'task') {
        // í• ì¼ ì™„ë£Œ -> ë¨¹ê¸°
        log("> Task Done! Yummy!");
        setExp(10);
        
        // ì´ë¯¸ì§€ ë³€ê²½
        charImg.src = './assets/eat.png';
        charImg.className = 'character'; // idle ì• ë‹ˆë©”ì´ì…˜ ë„ê¸°
        
        setTimeout(() => {
          charImg.src = './assets/normal.png';
          charImg.className = 'character idle';
          state.isBusy = false;
        }, 3000);
      }
    }

    function setExp(amount) {
      state.exp += amount;
      if (state.exp >= 100) {
        state.level++;
        state.exp -= 100;
        log(`ğŸ‰ Level Up! LV.${state.level}`);
        
        // ë ˆë²¨ì—… ë¦¬ì•¡ì…˜ (Happy)
        const prevSrc = charImg.src;
        charImg.src = './assets/happy.png';
        setTimeout(() => {
          if(!state.isBusy) charImg.src = './assets/normal.png';
        }, 2000);
      }
      renderUI();
    }

    function renderUI() {
      levelVal.innerText = state.level;
      expFill.style.width = `${state.exp}%`;
    }

    function log(msg) {
      const entry = document.createElement('div');
      entry.textContent = msg;
      entry.style.marginBottom = '2px';
      logText.insertBefore(entry, logText.firstChild);
      
      // ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ í‘œì‹œ
      while (logText.children.length > 5) {
        logText.removeChild(logText.lastChild);
      }
    }

    function resetGame() {
      state.level = 1;
      state.exp = 0;
      state.isBusy = false;
      charImg.style.display = 'block';
      charImg.src = './assets/normal.png';
      charImg.className = 'character idle';
      wheelSprite.classList.remove('active');
      renderUI();
      logText.innerHTML = '<div>> Welcome to Hamster World!</div>';
    }

    init();
  </script>
</body>
</html>
=======
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hamster Damagochi Widget</title>

  <!-- âœ… í”½ì…€ í°íŠ¸ (LEVEL í‘œì‹œìš©) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <style>
    :root{
      --screen-inset: 8px;  /* âœ… ì—¬ê¸° ìˆ«ìë§Œ ë°”ê¾¸ë©´ ë¹„ì¹¨ ì¡°ì ˆë¨(6~12 ì¶”ì²œ) */
      /* =========================================================
        âœ… ì—¬ê¸°ì„œ ìœ„ì¹˜ ì¡°ì ˆí•˜ì„¸ìš” (í”„ë ˆì„ ê¸°ì¤€ ì¢Œí‘œ)
        - ë‹¨ìœ„: px
        - ê¸°ì¤€: game-container (frame.png) ì¢Œìƒë‹¨ (0,0)
      ========================================================= */

      /* í”„ë ˆì„ ì›ë³¸ í¬ê¸° */
      --frame-w: 673px;
      --frame-h: 371px;

      /* (A) í™”ë©´ êµ¬ë©(ì›í˜•) ìœ„ì¹˜/í¬ê¸°: bgì™€ ìºë¦­í„°ê°€ ë“¤ì–´ê°€ëŠ” ì˜ì—­ */
      --screen-left: 170px;  /* ì•½ê°„ ì˜¤ë¥¸ìª½ */
      --screen-top:  10px;   /* ìœ„ë¡œ ì˜¬ë¦¼ */
      --screen-size: 330px;  /* ì‚´ì§ ì¤„ì„(ì‚ì ¸ë‚˜ì˜´ ë°©ì§€) */

      /* (B) ìºë¦­í„° ìœ„ì¹˜/í¬ê¸° (í™”ë©´ êµ¬ë© ì•ˆ ê¸°ì¤€) */
      --ham-size: 300px; /* í¬ê²Œ */
      --ham-x: 50%;   /* í™”ë©´ êµ¬ë© ë‚´ë¶€ì—ì„œ ì¢Œìš°(%) */
      --ham-y: 68%;   /* ì‚´ì§ ì•„ë˜ë¡œ (ë°œì´ ë°”ë‹¥ì— ë‹¿ëŠ” ëŠë‚Œ) */

      /* (C) ì˜¤ë¥¸ìª½ ë²„íŠ¼ 3ê°œ(íˆ¬ëª… í´ë¦­ ì˜ì—­) */
      /* â—€ */
      --btnL-left: 520px;
      --btnL-top:  240px;
      --btnL-w:    44px;
      --btnL-h:    40px;

      /* â–  (ë°¥ ì£¼ê¸°) */
      --btnC-left: 565px;
      --btnC-top:  240px;
      --btnC-w:    48px;
      --btnC-h:    40px;

      /* â–¶ (ì“°ë‹¤ë“¬ê¸°) */
      --btnR-left: 613px;
      --btnR-top:  240px;
      --btnR-w:    48px;
      --btnR-h:    40px;

      /* (D) EXP ë°” ìŠ¬ë¡¯(í”„ë ˆì„ ì™¼ìª½ EXP ë¹ˆì¹¸ì— ë§ì¶”ê¸°) */
      --exp-left:  68px;
      --exp-top:   254px;
      --exp-w:     94px;
      --exp-h:     13px;

      /* (E) LEVEL ìˆ«ì ìŠ¬ë¡¯(í”„ë ˆì„ ì™¼ìª½ LEVEL ë¹ˆì¹¸ì— ë§ì¶”ê¸°) */
      --lvl-left:  46px;
      --lvl-top:   283px;

      /* ========================================================= */

      /* ìƒ‰ìƒ */
      --bg: #0c1020;
      --text: #e8ecff;
      --muted: rgba(232,236,255,.75);
      --bar-bg: rgba(0,0,0,.35);
      --bar-fill1: #7cffb2;
      --bar-fill2: #7cc7ff;

      /* ë²„íŠ¼ í´ë¦­ í”¼ë“œë°± */
      --press-scale: 0.96;

      /* ë°°ê²½ ë¯¸ì„¸ í™•ëŒ€(ê°€ì¥ìë¦¬ ë¹ˆí‹ˆ ë°©ì§€) */
      --bg-scale: 1.04;
    }

    *{ box-sizing:border-box; }
    html, body { height: 100%; }

    body{
      margin:0;
      display:grid;
      place-items:center;
      background:
        radial-gradient(1200px 600px at 50% 30%, #18224a 0%, rgba(24,34,74,0) 60%),
        linear-gradient(180deg, #070a16 0%, var(--bg) 60%);
      color:var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
      padding: 12px;
    }

    /* âœ… ë…¸ì…˜ ì„ë² ë“œ/ëª¨ë°”ì¼ ëŒ€ì‘: JSê°€ scaleì„ ê³„ì‚°í•´ì„œ ë³€ìˆ˜ë¥¼ ë„£ìŒ */
    .wrap{
      width: min(100%, var(--frame-w));
      display:grid;
      justify-items:center;
    }

    .game-container{
      position: relative;
      width: var(--frame-w);
      height: var(--frame-h);
      transform: scale(var(--scale, 1));
      transform-origin: top center;
      will-change: transform;
    }

    /* ===== Layer 1 (z:10) - bg ===== */
    .layer-bg{
      position:absolute;
      left: var(--screen-left);
      top:  var(--screen-top);
      width: var(--screen-size);
      height: var(--screen-size);
      z-index: 10;
      overflow:hidden;
      border-radius: 999px;
      clip-path: circle(calc(50% - var(--screen-inset)) at 50% 50%);
      pointer-events:none;
      box-shadow: 0 0 0 6px rgba(0,0,0,0.0); /* ìë¦¬ë§Œ ìœ ì§€ìš©(ì˜µì…˜) */
    }
    .layer-bg img{
      width:100%;
      height:100%;
      object-fit: cover;
      transform: scale(var(--bg-scale));
      image-rendering: pixelated;
      user-select:none;
      -webkit-user-drag:none;
    }

    /* ===== Layer 2 (z:20) - hamster ===== */
    .layer-ham{
      position:absolute;
      left: var(--screen-left);
      top:  var(--screen-top);
      width: var(--screen-size);
      height: var(--screen-size);
      z-index: 20;
      pointer-events:none;
      overflow: hidden;
      border-radius: 999px;
      clip-path: circle(calc(50% - var(--screen-inset)) at 50% 50%);
    }
    .ham{
      position:absolute;
      left: var(--ham-x);
      top:  var(--ham-y);
      width: var(--ham-size);
      height: var(--ham-size);
      transform: translate(-50%,-50%);
      image-rendering: pixelated;
      user-select:none;
      -webkit-user-drag:none;
    }

    /* âœ… ê¸°ë³¸ ìƒíƒœ: ë‘¥ì‹¤ë‘¥ì‹¤ */
    .ham.bounce{
      animation: breathe 2.6s ease-in-out infinite;
    }
    @keyframes breathe{
      0%,100%{ transform: translate(-50%,-50%) translateY(0); }
      50%{     transform: translate(-50%,-50%) translateY(-6px); }
    }

    /* ===== Layer 3 (z:30) - frame ===== */
    .layer-frame{
      position:absolute;
      inset:0;
      z-index: 30;
      pointer-events:none;
    }
    .layer-frame img{
      width:100%;
      height:100%;
      image-rendering: pixelated;
      user-select:none;
      -webkit-user-drag:none;
    }

    /* ===== Layer 4 (z:40) - UI overlay ===== */
    .layer-ui{
      position:absolute;
      inset:0;
      z-index: 40;
    }

    /* íˆ¬ëª… ë²„íŠ¼ë“¤ */
    .hit{
      position:absolute;
      background: rgba(255,255,255,0); /* ì™„ì „ íˆ¬ëª… */
      border-radius: 10px;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      transform-origin:center;
    }
    .hit:active{
      transform: scale(var(--press-scale));
    }

    .hit.left{
      left: var(--btnL-left);
      top:  var(--btnL-top);
      width: var(--btnL-w);
      height:var(--btnL-h);
    }
    .hit.center{
      left: var(--btnC-left);
      top:  var(--btnC-top);
      width: var(--btnC-w);
      height:var(--btnC-h);
    }
    .hit.right{
      left: var(--btnR-left);
      top:  var(--btnR-top);
      width: var(--btnR-w);
      height:var(--btnR-h);
    }

    /* EXP ë°” (í”„ë ˆì„ ì™¼ìª½ ìŠ¬ë¡¯ì— ë§ì¶¤) */
    .exp-bar{
      position:absolute;
      left: var(--exp-left);
      top:  var(--exp-top);
      width: var(--exp-w);
      height:var(--exp-h);
      background: transparent;  /* âœ… ê²€ì€ ë°°ê²½ ì œê±° */
      border-radius: 3px;
      overflow:hidden;
      box-shadow: none;   /* âœ… í…Œë‘ë¦¬ë„ ì œê±°(í”„ë ˆì„ ìŠ¬ë¡¯ë§Œ ì‚´ë¦¬ê¸°) */
      pointer-events:none;
    }
    .exp-fill{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--bar-fill1), var(--bar-fill2));
      transition: width 180ms ease;
      box-shadow: 0 0 8px rgba(124,255,178,.18);
    }

    /* LEVEL í…ìŠ¤íŠ¸ */
    .level{
      position:absolute;
      left: var(--lvl-left);
      top:  var(--lvl-top);
      font-family: "Press Start 2P", system-ui, sans-serif;
      font-size: 9px;
      letter-spacing: 0.5px;
      color: rgba(255,255,255,.92);
      text-shadow: 0 1px 0 rgba(0,0,0,.55);
      pointer-events:none;
      width: 96px;              /* âœ… LEVEL ìŠ¬ë¡¯ í­(ì—¬ê¸°ë§Œ ë¯¸ì„¸ì¡°ì •) */
      text-align: center;       /* âœ… ìˆ«ì ì¤‘ì•™ì •ë ¬ */
      line-height: 1;           /* ì¤„ë†’ì´ ì˜í–¥ ì¤„ì´ê¸° */
      height: 14px;            /* ìŠ¬ë¡¯ ë†’ì´ ëŠë‚Œ */
      display:flex;
      align-items:center;
      justify-content:flex-end; /* âœ… í° ìˆ«ìë„ ì˜¤ë¥¸ìª½ ê¸°ì¤€ìœ¼ë¡œ ì•ˆì • */
      padding-right: 6px;       /* ìŠ¬ë¡¯ ì•ˆìª½ ì—¬ë°± */
    }

    /* ì‘ì€ ìƒíƒœ í…ìŠ¤íŠ¸(ë””ë²„ê·¸/ì˜µì…˜) */
    .debug{
      position:absolute;
      left: 18px;
      top:  18px;
      font-size: 10px;
      color: var(--muted);
      pointer-events:none;
      display:none; /* í•„ìš”í•˜ë©´ block */
    }
    /* âœ… ë””ë²„ê·¸: hitbox ë³´ì´ê¸°(í† ê¸€) */
    .debug-hit .hit{
      outline: 1px dashed rgba(124,199,255,.9);
      background: rgba(124,199,255,.12);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="game-container" id="game">
      <!-- Layer 1 -->
      <div class="layer-bg">
        <img src="./assets/bg.png" alt="">
      </div>

      <!-- Layer 2 -->
      <div class="layer-ham">
        <img id="ham" class="ham bounce" src="./assets/normal.png" alt="hamster">
      </div>

      <!-- Layer 3 -->
      <div class="layer-frame">
        <img src="./assets/frame.png" alt="">
      </div>

      <!-- Layer 4 -->
      <div class="layer-ui">
        <!-- Invisible buttons -->
        <div class="hit left"   id="btnLeft"   aria-label="left button"></div>
        <div class="hit center" id="btnFeed"   aria-label="feed button"></div>
        <div class="hit right"  id="btnPet"    aria-label="pet button"></div>

        <!-- EXP -->
        <div class="exp-bar" aria-hidden="true">
          <div class="exp-fill" id="expFill"></div>
        </div>

        <!-- LEVEL -->
        <div class="level" id="lvlText">1</div>

        <!-- debug -->
        <div class="debug" id="dbg"></div>
      </div>
    </div>
  </div>

  <script>
    /* =========================================================
      Hamster Damagochi Widget (Single File)
      - localStorageë¡œ EXP/LEVEL ìœ ì§€
      - Feed(â– ): exp +10, 2ì´ˆ eat
      - Pet(â–¶):  exp +5,  2ì´ˆ happy
      - normal ìƒíƒœì—ì„œë§Œ bounce
    ========================================================= */

    const IMG = {
      normal: "./assets/normal.png",
      eat:    "./assets/eat.png",
      happy:  "./assets/happy.png",
      sad:    "./assets/sad.png",
    };

    const LS_KEY = "hamster_damagochi_v1";

    // âœ… mood(ìë™ sad) ê¸°ëŠ¥ ON/OFF ìŠ¤ìœ„ì¹˜
    const ENABLE_MOOD = false;

    const game = document.getElementById("game");
    const ham = document.getElementById("ham");
    const expFill = document.getElementById("expFill");
    const lvlText = document.getElementById("lvlText");
    const dbg = document.getElementById("dbg");

    const btnLeft = document.getElementById("btnLeft"); // ê¸°ëŠ¥ ì—†ìŒ(í™•ì¥ìš©)
    const btnFeed = document.getElementById("btnFeed"); // â– 
    const btnPet  = document.getElementById("btnPet");  // â–¶

    let level = 1;
    let exp = 0;         // 0~99 (100 ë˜ë©´ ë ˆë²¨ì—…)
    let state = "normal";
    let busy = false;

    // ì˜µì…˜: ì‹œê°„ì´ ì§€ë‚˜ë©´ ìš°ìš¸(ë‚˜ì¤‘ í™•ì¥ìš©)
    let mood = 80;       // 0~100

    function load(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if(!raw) return;
        const data = JSON.parse(raw);
        if(typeof data.level === "number") level = clampInt(data.level, 1, 999);
        if(typeof data.exp === "number")   exp   = clampInt(data.exp, 0, 99);
        if(typeof data.mood === "number")  mood  = clampInt(data.mood, 0, 100);
      }catch(e){}
    }

    function save(){
      const data = { level, exp, mood };
      localStorage.setItem(LS_KEY, JSON.stringify(data));
    }

    function clampInt(n, min, max){
      n = Math.floor(Number(n) || 0);
      if(n < min) return min;
      if(n > max) return max;
      return n;
    }

    function setState(next){
      state = next;
      ham.src = IMG[next] || IMG.normal;

      // âœ… normalì¼ ë•Œë§Œ ë‘¥ì‹¤ë‘¥ì‹¤
      if(next === "normal") ham.classList.add("bounce");
      else ham.classList.remove("bounce");
    }

    function updateUI(){
      // EXPëŠ” 0~99, ë°”ëŠ” 0~100%ë¡œ í‘œì‹œ
      const pct = Math.min(100, Math.max(0, (exp / 100) * 100));
      expFill.style.width = pct + "%";
      lvlText.textContent = String(level);

      // dbg.textContent = `state=${state} exp=${exp} lvl=${level} mood=${mood}`;
    }

    function addExp(amount){
      amount = clampInt(amount, 0, 1000);
      let total = exp + amount;

      let leveledUp = false;
      while(total >= 100){
        total -= 100;
        level += 1;
        leveledUp = true;
      }

      exp = total;

      if(leveledUp) levelUpFlash();  // âœ… í•œ ë²ˆë§Œ ì—°ì¶œ

      save();
      updateUI();
    }
    let flashTimer = null;
    function levelUpFlash(){
      // busy ì¤‘ì´ì–´ë„ ë ˆë²¨ì—… í‘œì‹œëŠ” ì§§ê²Œë§Œ
      clearTimeout(flashTimer);
      const prev = state;
      setState("happy");
      flashTimer = setTimeout(()=>{
        // ì•¡ì…˜ ì¤‘ì´ë©´ ìƒíƒœë¥¼ ê±´ë“œë¦¬ì§€ ì•ŠìŒ(ì•¡ì…˜ì´ ëë‚˜ë©´ normalë¡œ ëŒì•„ê°)
        if(!busy) setState("normal");
        else setState(prev);
      }, 700);
    }

    async function doAction(kind){
      if(busy) return;
      busy = true;

      if(kind === "feed"){
        // â–  ë°¥ ì£¼ê¸°: +10, 2ì´ˆ eat
        addExp(10);
        mood = clampInt(mood + 6, 0, 100);
        setState("eat");
        save(); updateUI();
        await wait(2000);
        setState("normal");
      }

      if(kind === "pet"){
        // â–¶ ì“°ë‹¤ë“¬ê¸°: +5, 2ì´ˆ happy
        addExp(5);
        mood = clampInt(mood + 10, 0, 100);
        setState("happy");
        save(); updateUI();
        await wait(2000);
        setState("normal");
      }

      busy = false;
    }

    function wait(ms){ return new Promise(r=>setTimeout(r, ms)); }

    // âœ… ë°˜ì‘í˜• ìŠ¤ì¼€ì¼: ë…¸ì…˜ ì„ë² ë“œ/ëª¨ë°”ì¼ì—ì„œ ì˜ë¦¬ì§€ ì•Šê²Œ
    function applyScale(){
      const fw = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--frame-w")) || 673;
      const pad = 24; // body padding ê³ ë ¤
      const maxW = Math.max(320, window.innerWidth - pad);
      const s = Math.min(1, maxW / fw);
      game.style.setProperty("--scale", String(s));
    }
    window.addEventListener("resize", applyScale);

    // ë²„íŠ¼ ì´ë²¤íŠ¸
    btnLeft.addEventListener("click", ()=>{ /* ê¸°ëŠ¥ ì—†ìŒ(í™•ì¥ìš©) */ });

    btnFeed.addEventListener("click", ()=>doAction("feed"));
    btnPet.addEventListener("click",  ()=>doAction("pet"));

    // âœ… Dí‚¤ë¡œ hitbox ì‹œê°í™” í† ê¸€
    window.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "d") document.body.classList.toggle("debug-hit");
    });

      if (ENABLE_MOOD) {
        setInterval(()=>{
          if(busy) return;
          mood = clampInt(mood - 2, 0, 100);
          if(mood <= 25) setState("sad");
          else if(state === "sad") setState("normal");
          save();
          updateUI();
        }, 15000);
      }

    // init
    load();
    applyScale();
    setState("normal");
    updateUI();
  </script>
</body>
</html>
>>>>>>> ea985dc1ae0da7b2a57f2fd28c699ebd8867d13f
